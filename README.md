# Reproducible Code for "Stationarity of Manifold Time Series"

This repository contains the code for reproducing the results of the paper:

**"Stationarity of Manifold Time Series"**

[arXiv preprint](https://arxiv.org/abs/2409.17706)

For your convenience, each folder also includes all the numerical results generated by the code, allowing you to save time.

## ðŸ“‚ Contents

- `SPD_first_order_in_main/`: reproduce the first order stationarity test results for SPD setting in the main paper. Please run the 'Spd3.py'

- `Sphere_first_order_in_main/`: reproduce the first order stationarity test results for sphere setting in the main paper. Please run the 'Sphere_H0.py' for type-I error under the null, and 'Sphere.py' for power study under the alternativs.

 - `Second_order_SPD_d=3/`: reproduce the second order stationarity test results for SPD setting in the main paper.  Please run the 'SPD_LOCSTA_d=6.ipynb'

- `Second_order_sphere_d=6/`: reproduce the second order stationarity test results for sphere setting in the main paper Please run the 'SPD_LOCSTA_d=6.ipynb'

- `RealData/`: The scRNA-seq data analysis and fMRI data analysis. 

    - For scRNA-seq data analysis, please run 'celltype_first_main.ipynb' for the first order stationarity test in the main paper, and run the 'celltype_second_main.ipynb' for the second-order stationarity test in the main paper. Moreover, we provide the test results under Euclidean geometry and  Aitchison geometry in 'celltype_first_more_geometry.ipynb' and 'celltype_second_more_geometry.ipynb'.
    
    The preprocessed data are given by 'ot_df.csv' and 'time_names.csv'

    - The code for data pre-processing and testing of fMRI data in the supplmentary materials are included in the 'Preprocess and test.ipynb'. Please note that we are unable to distribute the HCP data due to restrictions from the data provider. If you would like to access the preprocessed data for research purposes, please contact us directly.
   
- `major_VAR`: reproduce the numerical results in Vector Auto-Regressive setting. Please run the 'spd_var.py' and 'spd_var_power_eu.py' to reproduce the results of SPD matrices and run the 'Sphere_var.py' and 'Sphere_var_power_eu.py' to reproduce the result of the spherical setting. 

- `major_revision_firstorder_simu_spheer_preselected/`: reproduce the first-order stationarity test results with comparison to method with pre-selected base point in the supplmentary materials. Please run the 'Sphere_H0_major.py' for  type-I error study under the null and 'Sphere_major.py' for power study under the alternatives.

- `major_revision_second_order_sphere/`: reproduce the second-order stationarity test results with comparison to method with pre-selected base point in the supplmentary materials. Please run the 'Sphere_LOCSTA_d=6_major_preselectbp.ipynb'.


- `major_revision_firstorder_power comparison_for_B1B2/`: reproduce the power curve of B1 and B2 in the supplement. Please run the 'major_revision_second_order_sphere.ipynb'.

